<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yang.jxc.mapper.MenuMapper">

    <select id="selectShowMenuByAdminName" resultType="com.yang.jxc.domain.entity.Menu">
        SELECT *
        FROM menu
        WHERE parent_id = 0
          AND id IN (SELECT menu_id
                     FROM role_menu_relation
                     WHERE role_id IN (SELECT role_id
                                       FROM admin_role_relation role_id
                                       WHERE admin_id IN (SELECT id
                                                          FROM admin
                                                          WHERE user_name = #{userName})))
        ORDER BY sort
    </select>


    <select id="selectChildMenuByAdminName" resultType="com.yang.jxc.domain.entity.Menu">
        SELECT *
        FROM menu
        WHERE parent_id = #{id}
          AND id IN (SELECT menu_id
                     FROM role_menu_relation
                     WHERE role_id IN (SELECT role_id
                                       FROM admin_role_relation role_id
                                       WHERE admin_id IN (SELECT id
                                                          FROM admin
                                                          WHERE user_name = #{userName})))
        ORDER BY sort
    </select>
</mapper>
